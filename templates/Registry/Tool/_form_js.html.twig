<script>
    $(document).ready(function(){
        var showDependents = function($el) {
            var val = $el.val()

            if(val === ''){
                $('#tool_country_name').attr('required', false).parent().parent().hide()
                $('#tool_country_guarantees').attr('required', false).parent().parent().hide()
            }

            if (val === 'registry.tool.country.france') {
                $('#tool_country_name').attr('required', false).parent().parent().hide()
                $('#tool_country_guarantees').attr('required', false).parent().parent().hide()
            }
            if (val === 'registry.tool.country.eu') {
                $('#tool_country_name').attr('required', false).parent().parent().show()
                $('#tool_country_guarantees').attr('required', false).parent().parent().hide()
            }
            if (val === 'registry.tool.country.other') {
                $('#tool_country_name').attr('required', false).parent().parent().show()
                $('#tool_country_guarantees').attr('required', true).parent().parent().show()
            }
        }

        $('#tool_country_type').on('change', function(e) {
            showDependents($(e.currentTarget))
        })

        showDependents($('#tool_country_type'))

        traiterBoutons('tool_contractors', 'Sous-traitants');
    })

    function traiterBoutons(label, ariaLabel) {
        const buttonElement = $(`button[data-id='${label}']`);
        if (buttonElement.attr('data-id') === undefined) {
            setTimeout(function(){
                traiterBoutons(label, ariaLabel);
            }, 1000);
            return; // Sortie de la fonction pour éviter d'exécuter le reste du code
        }
        buttonElement.removeAttr('role');
        buttonElement.attr('aria-label', ariaLabel);
    }
</script>
